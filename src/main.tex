%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Template fuer Abschlussarbeiten von Studierenden der 
% Frankfurt University of Applied Sciences
% 
% erstellt von: Prof. Dr.-Ing. Thomas Hollstein
% 
% Last revision: 22.06.2023
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\documentclass[
    %twoside, 
    %openright,
  titlepage,
  numbers=noenddot,
  headinclude,
    %1headlines,
  footinclude=true,
    %cleardoublepage=empty,
    %BCOR=5mm,
  fontsize=12pt,%11pt,
  paper=a4,
    %letterpaper
    %a4paper,
  ngerman,
  american,
    %table
  ]
% Dokumententyp: (legt grundlegende Formatierrichtlinien fest)
    %{book}
    %{report}
{scrreprt}
    %{scrreprt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


   

% Farbigen Text
\usepackage{xcolor}

\parindent = 0pt  % Neue Absaetze nicht einruecken
\parskip = 1.0\baselineskip % paragraph gap: one baseline for clearer separation

% Improve overall micro-typography and line spacing for better readability
\usepackage{microtype} % better justification and protrusion
\usepackage{setspace}
% Use a slightly increased line spacing similar to the black example
% 1.2-1.25 gives a more open, readable look; choose 1.22 as compromise
\setstretch{1.22}





%%%%%%%%%% zu nutzende Pakete einbinden: %%%%%%%%%%

%%%%% Package Kommentare:



\usepackage{comment}
\usepackage[colorinlistoftodos]{todonotes}
\newcommand{\mycomment}[1]{\todo[inline,linecolor=green,backgroundcolor=yellow!25,bordercolor=green,caption={}]{todo: #1}}



%%%%% package Sprachunterstuetzung:

\usepackage{babel}[ngerman]
\usepackage{csquotes}

%%%%% Package Multirow ermoeglicht, dass sich ein Kaestchen in einer Tabelle ueber mehrere Zeilen erstrecken kann:

\usepackage{multirow}

% Beispiele unter: https://texblog.org/2012/12/21/multi-column-and-multi-row-cells-in-latex-tables/

%Vereinigung von Feldern in Tabellen:
%\multicolumn{number cols}{align}{text} % align: l,c,r
%\multirow{number rows}{width}{text}

%%%% Serifenloser Textstil fuer das ganze Dokument: 

% Use fontspec for custom fonts (requires XeLaTeX or LuaLaTeX)
\usepackage{fontspec}

% Set Mona Sans as the main/sans-serif font
\setmainfont{MonaSans}[
    Path = ../fonts/mona-sans/static/otf/,
    Extension = .otf,
    UprightFont = *-Regular,
    BoldFont = *-Bold,
    ItalicFont = *-Italic,
    BoldItalicFont = *-BoldItalic
]

% Set Mona Sans as sans-serif font explicitly
\setsansfont{MonaSans}[
    Path = ../fonts/mona-sans/static/otf/,
    Extension = .otf,
    UprightFont = *-Regular,
    BoldFont = *-Bold,
    ItalicFont = *-Italic,
    BoldItalicFont = *-BoldItalic
]

% Set Monaspace for monospaced/code text
\setmonofont{Monaspace Neon}[
    Path = ../fonts/mona-space/Monaspace Neon/,
    Extension = .ttf,
    UprightFont = * Var
]

% Base font of the document is to be sans serif
\renewcommand*\familydefault{\sfdefault}

%%%%%% Grafiken einbinden
\usepackage{graphicx}
% https://golatex.de//wiki/%5cincludegraphics

%%%%%% Caption styling - even smaller and lighter
\usepackage{caption}
% Macro to select punctuation after the label: colon or period
% Usage: set to ":" or "." in the preamble
\providecommand{\CaptionLabelPunct}{.}
% Define a custom label format that appends the chosen punctuation
\DeclareCaptionLabelFormat{labelsepWithPunct}{#1~#2\CaptionLabelPunct\,}
\captionsetup{
  font={footnotesize,it},         % smaller and italic font for the caption
  labelfont={footnotesize,it},    % label smaller and italic (no bold)
  textfont={footnotesize,it},     % caption text smaller and italic
  labelsep=none,                 % we'll use a custom label format
  labelformat=labelsepWithPunct, % use the custom label format defined above
  justification=centering,       % Center-aligned captions
  skip=6pt                       % Reduced space between figure and caption
}

%%%%%% Mathematik-Paket AMSMath:
\usepackage[fleqn,reqno]{amsmath}
\usepackage{amssymb}  % Additional math symbols (e.g., \mathbb for number sets)


%%%%%% Seitengeometrie einstellen:
% https://tex.stackexchange.com/questions/344241/logo-as-header-using-fancyhdr-package
\usepackage{geometry}
\geometry{verbose,
          bmargin=2.5cm,
          lmargin=2cm,
          rmargin=2cm
          %footskip=-25pt
          }

%%%%%% die Höhe des Top-Margin errechnen:
\newlength\mytopmargin
\newsavebox{\headbox}\savebox{\headbox}{
    % Smaller header box for more compact design
    \raisebox{-0.5ex}{\includegraphics[height=1.2cm]{Figures/vgu-logo.pdf}}
}
\setlength{\mytopmargin}{\totalheightof{\usebox{\headbox}}+1.5cm}
\geometry{verbose,
          tmargin=\mytopmargin,
          headheight=1.8cm,
          footskip=8ex
}

% Flexiblere Tabellen
\usepackage{tabularx}
\def\tabularxcolumn#1{m{#1}}

% Boxen für Lickert Skalen
\usepackage{wasysym}
\newcommand\insq[1]{%
    \Square\ #1\quad%
}

% Durchstreichen von Text
\usepackage[normalem]{ulem} % mit \sout

%%%%%% Code listings with syntax highlighting
\usepackage{listings}
\usepackage{xcolor} % already loaded earlier, but needed for listings colors
\lstset{
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{gray}\itshape,
    stringstyle=\color{red},
    numberstyle=\tiny\color{gray},
    numbers=left,
    numbersep=8pt,
    frame=single,
    breaklines=true,
    breakatwhitespace=true,
    showstringspaces=false,
    tabsize=2,
    captionpos=b,
    aboveskip=1.5em,
    belowskip=1em
}

%%%%%% Algorithm and pseudocode formatting
\usepackage{algorithm}
\usepackage{algpseudocode}

%%%%%% Subfigures support
\usepackage{subcaption}

%%%%%% Professional table formatting (booktabs)
\usepackage{booktabs}

%%%%%% Enhanced list environments - using paralist (already loaded earlier)
% Note: enumitem conflicts with paralist, so we use paralist which is already loaded



%%%%%% Gesamtseitenzahl verwenden:
\usepackage{totpages}

%%%%%% Kalkulationen:
%https://tex.stackexchange.com/questions/30081/how-can-i-sum-two-values-and-store-the-result-in-other-variable
\usepackage{tikz}
\usetikzlibrary{math}

%%%%%% Gestaltung von Kopf- und Fusszeilen:
% https://tex.stackexchange.com/questions/344241/logo-as-header-using-fancyhdr-package
\usepackage{fancyhdr}
\pagestyle{fancy}  % Eigener Seitenstil
\fancyhf{}         % Alle Kopf- und Fußzeilenfelder bereinigen

% Header configuration - smaller and more elegant
\fancyhead[L]{%
  \fontsize{9}{11}\selectfont\fontseries{l}\selectfont% Light weight, smaller font
  \leftmark%
}
\fancyhead[C]{%
  \fontsize{8.5}{10}\selectfont\fontseries{l}\selectfont% Extra light, smaller
  \rightmark%
}
\fancyhead[R]{%
  \raisebox{-0.5ex}{% Reduced vertical offset
    \includegraphics[height=0.5cm]{Figures/vgu-logo.pdf}% Smaller logos
    \hspace{0.5em}% Reduced spacing
    \includegraphics[height=0.5cm]{Figures/company-logo.png}%
  }%
}

\renewcommand{\headrulewidth}{0.3pt} % Thinner header line
\setlength{\headheight}{1.8cm} % Reduced header height

% Footer configuration - minimal and elegant
\fancyfoot[C]{%
  \fontsize{8.5}{10}\selectfont\fontseries{l}\selectfont% Light weight
  \textit{\ThesisTitleShort}% Italic for elegance
} 
\fancyfoot[R]{%
  \fontsize{9}{11}\selectfont\fontseries{m}\selectfont% Medium weight
  \thepage% Page number
}
\renewcommand{\footrulewidth}{0.2pt} % Thinner footer line
\setlength{\mytopmargin}{\totalheightof{\usebox\headbox} +1.5cm}% Reduced margin
%Unterschied zwischen geraden/ungeraden Seiten:
%\fancyhead[OR]{} % "O" steht für "odd", also ungerade Seiten
%\fancyhead[ER]{} % "E" für "even", also gerade Seiten.




%%%%% Erweiterte Formate für Listen/Aufzaehlungen:
\usepackage{paralist}
%Default-Items fuer die vier moeglichen Verschachtelungsebenen:
\setdefaultitem{}{\textbullet}{$\star$}{}

%%%%% FRA-UAS CI Farben:
%\definecolor{airforceblue}{rgb}{0.36, 0.54, 0.66}
% CI-Farben FRA-UAS (blau):
\definecolor{FRAUAS_Blue_Dark}{RGB}{45, 137, 204}
\definecolor{FRAUAS_Blue_Light}{RGB}{182, 210, 228}
% CI-Farben FRA-UAS: FB1
\definecolor{FRAUAS_FB1_Dark}{RGB}{124, 128, 52}
\definecolor{FRAUAS_FB1_Light}{RGB}{213, 213, 179}
% CI-Farben FRA-UAS: FB2
\definecolor{FRAUAS_FB2_Dark}{RGB}{255, 158, 27}
\definecolor{FRAUAS_FB2_Light}{RGB}{251, 221, 173}
% CI-Farben FRA-UAS: FB3
\definecolor{FRAUAS_FB3_Dark}{RGB}{196, 213, 42}
\definecolor{FRAUAS_FB3_Light}{RGB}{237, 240, 166}
% CI-Farben FRA-UAS: FB4
\definecolor{FRAUAS_FB4_Dark}{RGB}{204, 31, 47}
\definecolor{FRAUAS_FB4_Light}{RGB}{240, 166, 183}

%% VGU COLOR
\definecolor{VGU_ORANGE}{RGB}{196, 67, 45}

%%%%% Sektionstitel nach CI-Farben einfärben:
\usepackage{titlesec}
\titleformat{\section}
{\color{VGU_ORANGE}\normalfont\Large\bfseries} %Titel
{\color{VGU_ORANGE}\thesection}{1em}{}
\titleformat{\subsection}
{\color{VGU_ORANGE}\normalfont\large\bfseries} %Titel
{\color{VGU_ORANGE}\thesubsection}{1em}{}

%\usepackage{appendix}

%%%%% Erweiterte Bibliographie-Stile:
%\usepackage{harvard}
% Title Page
% (wir generieren den Titel per Handlayout und verwenden
% daher die folgenden Befehle nicht)
%\title{}
%\author{}

% https://www.overleaf.com/learn/latex/Hyperlinks
\usepackage{hyperref}
\hypersetup{
    %hyperindex=true,
    %linktocpage=true, % Seitenzahl statt Titel verlinkt
    colorlinks=true,
    linkcolor=black,
    filecolor=black,
    urlcolor=black,
    pdftitle={Thesis},
    pdfpagemode=FullScreen,
    citecolor=black,
    }



%\usepackage[hyphens]{url}  %% stellt \url{} zur Verfuegung

%%%%% modernes BibLaTeX mit biber %%%%%
% https://golatex.de/viewtopic.php?t=13917
%\usepackage[style=ieee-alphabetic,
%backend=biber, natbib=true]{biblatex}

% Literatur nach Erscheinen im Text sortiert
%\usepackage[sorting=none, style=numeric,backend=biber, natbib=true]{biblatex}
%\usepackage[style=apa, backend=biber, natbib=true, sorting=nyt, sortcites=false]{biblatex}
\usepackage[style=numeric, backend=biber, natbib=true, sorting=nyt, sortcites=false]{biblatex}
% Ohne eingestellte Sortierung
%\usepackage[ style=numeric,
%backend=biber, natbib=true]{biblatex}


\addbibresource{bibliography.bib}

% Immer shortautor anzeigen, falls vorhanden
\makeatletter
\def\cbx@apa@ifnamesaved{\@firstoftwo}
\makeatother

% Zeilenabstand für das ganze Dokument (1.0 = Normalwert):
\renewcommand{\baselinestretch}{1.0}

%%%%% Glossaries and Acronyms setup:
\usepackage[acronym,toc]{glossaries}
\makeglossaries

%%%%% Acronymdefinitionen einbinden:
\input{TeXFiles/005_Acronyms}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% hier beginnt das eigentliche Dokument 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}


%%%%% Settings einbinden:
\input{TeXFiles/000_Settings}
\sloppy %Formatierungsueberstaende am Zeilenende vermeiden
% https://latexref.xyz/_005cfussy-_0026-_005csloppy.html

\frenchspacing
%Ein Leerzeichen nach Satzende
%https://texwelt.de/fragen/1154/was-ist-french-spacing-was-macht-frenchspacing

%\raggedbottom   
%Standard is \flushbottom, dass heisst
%alle Seiten werden so gedehnt, dass sie 
%gleich hoch sind 
%Schaltet man \raggedbottom ein, ist dies
%nicht so

\ifdefined\ThesisLanguageIsEnglish
  \selectlanguage{american}
\else
  \selectlanguage{ngerman} % ngerman, american
\fi
%Deutsch nach neuer Rechtschreibung als
%Standardsprache fuer das Dokument einstellen

%\renewcommand*{\bibname}{new name}
%\setbibpreamble{}

% Numerierungstiefe setzen:
% 2: bis subsection (Standard)
% 3: bis subsubsection
\setcounter{secnumdepth}{3} %setzt die Numerierungstiefe



%\renewcommand{\thepage}{\Roman{page}}
\pagestyle{plain} % Seite ohne Kopf- und Fusszeilen darstellen



% hier wird die Titelseite eingebunden:
\input{TeXFiles/001_Titlepage}
\input{TeXFiles/002_NDNotice}
\input{TeXFiles/003_Declaration}
\newpage

% da wir den Titel haendisch erstellt haben entfaellt der folgende Befehl:
%\maketitle

%\clearpage

%\pagestyle{headings} 
\pagestyle{fancy}   % Seite mit Kopf- und Fusszeilen darstellen
\pagenumbering{roman}  % Umschalten auf Seitenzahlen in römischer Darstellung
%\fancyfoot[R]{i}  % Seitennummer
%roemisch 1, hier per Hand eingetragen, weil es anders nicht funktioniert hat - hat sich erledigt


\tableofcontents
\clearpage
\pagenumbering{arabic}  % Umschalten auf Seitenzahlen in arabischer Darstellung
%%%%% Einbinden der Dateien für die einzelnen Sektionen:
% Verwendet man hier \include statt \input, beginnen
% neue Sektionen immer auf einer neuen Seite
%\input{TeXFiles/Abstract}

\fancyfoot[R]{\thepage}  % Seitennummer


%\myName
\input{TeXFiles/010_Kurzfassung}
\input{TeXFiles/004_LaTeXHowTo}      %%%%%% <<<<<< nach dem ersten Ansehen, bitte diese Zeile auskommentieren
\input{TeXFiles/020_Einfuehrung}
\input{TeXFiles/030_Hintergrund}
\input{TeXFiles/040_StandDerTechnik}
\input{TeXFiles/050_EntwickelteMethode}
\input{TeXFiles/060_EvaluationDerMethode}
\input{TeXFiles/070_Ergebnisse}
\input{TeXFiles/080_Zusammenfassung}

\begin{appendix}
  \input{TeXFiles/090_Anhang}
\end{appendix}

\clearpage

% Only print glossary entries that are referenced in the text
% To print all entries (even unreferenced), uncomment the line below:
% \glsaddall

\ifdefined\ThesisLanguageIsEnglish
  \printglossary[type=\acronymtype, title=List of Abbreviations, toctitle=List of Abbreviations]
\else
  \printglossary[type=\acronymtype, title=Abkürzungsverzeichnis, toctitle=Abkürzungsverzeichnis]
\fi
%\printglossary[type=acronym,title=Abbreviations]
%\addcontentsline{toc}{section}{Abbreviations} 
%\addcontentsline{toc}{chapter*}{Verzeichnis: Akronyme} 
\clearpage

\ifdefined\ThesisLanguageIsEnglish
  \printglossary[title=Glossary, toctitle=Glossary]
\else
  % Ensure all glossary entries are included even if not referenced in text
  \printglossary[title=Glossar, toctitle=Glossar]
\fi

%Falls man die Überschrift des Literaturverzeichnisses
%aendern moechte, geht das durch Verwendung der folgenden Zeile:
%\renewcommand*{\refname}{Literaturverzeichnis}

%\bibliographystyle{plain} % Nummern in eckigen Klammern
%%\bibliographystyle{alpha} % Anfangsbuchstaben Erstautor und Jahr

% Wenn man folgenden Stil verwenden will, dann muss
% \usepackage{harvard} vor \begin{document} aktiviert werden:
%\bibliographystyle{agsm} % (Autoren in runden Klammern)
%\newpage
\clearpage
%\phantomsection % Da sonst falsche Verlinkung im Inhaltsverzeichnis
\printbibliography[heading=bibintoc]    % Ohne Kapitelnummer /-buchstabe
%\printbibliography[heading=bibnumbered]    % Mit Kapitelnummer /-buchstabe
\end{document}
